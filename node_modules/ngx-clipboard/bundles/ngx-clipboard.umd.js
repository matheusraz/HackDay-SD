(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/platform-browser'), require('ngx-window-token'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('ngx-clipboard', ['exports', '@angular/core', '@angular/platform-browser', 'ngx-window-token', '@angular/common'], factory) :
    (factory((global['ngx-clipboard'] = {}),global.ng.core,global.ng.platformBrowser,null,global.ng.common));
}(this, (function (exports,core,platformBrowser,ngxWindowToken,common) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var ClipboardService = (function () {
        function ClipboardService(document, window) {
            this.document = document;
            this.window = window;
        }
        Object.defineProperty(ClipboardService.prototype, "isSupported", {
            get: /**
             * @return {?}
             */ function () {
                return (!!this.document.queryCommandSupported &&
                    !!this.document.queryCommandSupported('copy'));
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @param {?} element
         * @return {?}
         */
        ClipboardService.prototype.isTargetValid = /**
         * @param {?} element
         * @return {?}
         */
            function (element) {
                if (element instanceof HTMLInputElement ||
                    element instanceof HTMLTextAreaElement) {
                    if (element.hasAttribute('disabled')) {
                        // tslint:disable-next-line:max-line-length
                        throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');
                    }
                    return true;
                }
                throw new Error('Target should be input or textarea');
            };
        /**
         * copyFromInputElement
         * @param {?} targetElm
         * @return {?}
         */
        ClipboardService.prototype.copyFromInputElement = /**
         * copyFromInputElement
         * @param {?} targetElm
         * @return {?}
         */
            function (targetElm) {
                try {
                    this.selectTarget(targetElm);
                    var /** @type {?} */ re = this.copyText();
                    this.clearSelection(targetElm, this.window);
                    return re;
                }
                catch (error) {
                    return false;
                }
            };
        /**
         * Creates a fake textarea element, sets its value from `text` property,
         * and makes a selection on it.
         * @param {?} content
         * @return {?}
         */
        ClipboardService.prototype.copyFromContent = /**
         * Creates a fake textarea element, sets its value from `text` property,
         * and makes a selection on it.
         * @param {?} content
         * @return {?}
         */
            function (content) {
                if (!this.tempTextArea) {
                    this.tempTextArea = this.createTempTextArea(this.document, this.window);
                    this.document.body.appendChild(this.tempTextArea);
                }
                this.tempTextArea.value = content;
                return this.copyFromInputElement(this.tempTextArea);
            };
        /**
         * @return {?}
         */
        ClipboardService.prototype.destroy = /**
         * @return {?}
         */
            function () {
                if (this.tempTextArea) {
                    this.document.body.removeChild(this.tempTextArea);
                    this.tempTextArea = undefined;
                }
            };
        /**
         * @param {?} inputElement
         * @return {?}
         */
        ClipboardService.prototype.selectTarget = /**
         * @param {?} inputElement
         * @return {?}
         */
            function (inputElement) {
                inputElement.select();
                inputElement.setSelectionRange(0, inputElement.value.length);
                return inputElement.value.length;
            };
        /**
         * @return {?}
         */
        ClipboardService.prototype.copyText = /**
         * @return {?}
         */
            function () {
                return this.document.execCommand('copy');
            };
        /**
         * @param {?} inputElement
         * @param {?} window
         * @return {?}
         */
        ClipboardService.prototype.clearSelection = /**
         * @param {?} inputElement
         * @param {?} window
         * @return {?}
         */
            function (inputElement, window) {
                // tslint:disable-next-line:no-unused-expression
                inputElement && inputElement.blur();
                window.getSelection().removeAllRanges();
            };
        /**
         * @param {?} doc
         * @param {?} window
         * @return {?}
         */
        ClipboardService.prototype.createTempTextArea = /**
         * @param {?} doc
         * @param {?} window
         * @return {?}
         */
            function (doc, window) {
                var /** @type {?} */ isRTL = doc.documentElement.getAttribute('dir') === 'rtl';
                var /** @type {?} */ ta;
                ta = doc.createElement('textarea');
                // Prevent zooming on iOS
                ta.style.fontSize = '12pt';
                // Reset box model
                ta.style.border = '0';
                ta.style.padding = '0';
                ta.style.margin = '0';
                // Move element out of screen horizontally
                ta.style.position = 'absolute';
                ta.style[isRTL ? 'right' : 'left'] = '-9999px';
                // Move element to the same position vertically
                var /** @type {?} */ yPosition = window.pageYOffset || doc.documentElement.scrollTop;
                ta.style.top = yPosition + 'px';
                ta.setAttribute('readonly', '');
                return ta;
            };
        ClipboardService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        ClipboardService.ctorParameters = function () {
            return [
                { type: undefined, decorators: [{ type: core.Inject, args: [platformBrowser.DOCUMENT,] },] },
                { type: undefined, decorators: [{ type: core.Inject, args: [ngxWindowToken.WINDOW,] },] },
            ];
        };
        return ClipboardService;
    }());
    /**
     * @param {?} doc
     * @param {?} win
     * @param {?} parentDispatcher
     * @return {?}
     */
    function CLIPBOARD_SERVICE_PROVIDER_FACTORY(doc, win, parentDispatcher) {
        return parentDispatcher || new ClipboardService(doc, win);
    }
    var /** @type {?} */ CLIPBOARD_SERVICE_PROVIDER = {
        deps: [/** @type {?} */ (platformBrowser.DOCUMENT), /** @type {?} */ (ngxWindowToken.WINDOW), [new core.Optional(), new core.SkipSelf(), ClipboardService]
        ],
        provide: ClipboardService,
        useFactory: CLIPBOARD_SERVICE_PROVIDER_FACTORY
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var ClipboardDirective = (function () {
        function ClipboardDirective(clipboardSrv) {
            this.clipboardSrv = clipboardSrv;
            this.cbOnSuccess = new core.EventEmitter();
            this.cbOnError = new core.EventEmitter();
        }
        /**
         * @return {?}
         */
        ClipboardDirective.prototype.ngOnInit = /**
         * @return {?}
         */
            function () { };
        /**
         * @return {?}
         */
        ClipboardDirective.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.clipboardSrv.destroy();
            };
        /**
         * @param {?} event
         * @return {?}
         */
        ClipboardDirective.prototype.onClick = /**
         * @param {?} event
         * @return {?}
         */
            function (event) {
                if (!this.clipboardSrv.isSupported) {
                    this.handleResult(false, undefined);
                }
                else if (this.targetElm &&
                    this.clipboardSrv.isTargetValid(this.targetElm)) {
                    this.handleResult(this.clipboardSrv.copyFromInputElement(this.targetElm), this.targetElm.value);
                }
                else if (this.cbContent) {
                    this.handleResult(this.clipboardSrv.copyFromContent(this.cbContent), this.cbContent);
                }
            };
        /**
         * Fires an event based on the copy operation result.
         * @param {?} succeeded
         * @param {?} copiedContent
         * @return {?}
         */
        ClipboardDirective.prototype.handleResult = /**
         * Fires an event based on the copy operation result.
         * @param {?} succeeded
         * @param {?} copiedContent
         * @return {?}
         */
            function (succeeded, copiedContent) {
                if (succeeded) {
                    this.cbOnSuccess.emit({ isSuccess: true, content: copiedContent });
                }
                else {
                    this.cbOnError.emit({ isSuccess: false });
                }
            };
        ClipboardDirective.decorators = [
            { type: core.Directive, args: [{
                        // tslint:disable-next-line:directive-selector
                        selector: '[ngxClipboard]'
                    },] },
        ];
        /** @nocollapse */
        ClipboardDirective.ctorParameters = function () {
            return [
                { type: ClipboardService, },
            ];
        };
        ClipboardDirective.propDecorators = {
            "targetElm": [{ type: core.Input, args: ['ngxClipboard',] },],
            "cbContent": [{ type: core.Input },],
            "cbOnSuccess": [{ type: core.Output },],
            "cbOnError": [{ type: core.Output },],
            "onClick": [{ type: core.HostListener, args: ['click', ['$event.target'],] },],
        };
        return ClipboardDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var ClipboardModule = (function () {
        function ClipboardModule() {
        }
        ClipboardModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [common.CommonModule, ngxWindowToken.NgxWindowTokenModule],
                        // tslint:disable-next-line:object-literal-sort-keys
                        declarations: [ClipboardDirective],
                        exports: [ClipboardDirective],
                        providers: [CLIPBOARD_SERVICE_PROVIDER]
                    },] },
        ];
        return ClipboardModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.ClipboardService = ClipboardService;
    exports.CLIPBOARD_SERVICE_PROVIDER_FACTORY = CLIPBOARD_SERVICE_PROVIDER_FACTORY;
    exports.CLIPBOARD_SERVICE_PROVIDER = CLIPBOARD_SERVICE_PROVIDER;
    exports.ClipboardDirective = ClipboardDirective;
    exports.ClipboardModule = ClipboardModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWNsaXBib2FyZC51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC1jbGlwYm9hcmQvbGliL25neC1jbGlwYm9hcmQuc2VydmljZS50cyIsIm5nOi8vbmd4LWNsaXBib2FyZC9saWIvbmd4LWNsaXBib2FyZC5kaXJlY3RpdmUudHMiLCJuZzovL25neC1jbGlwYm9hcmQvbGliL25neC1jbGlwYm9hcmQubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEluamVjdCxcbiAgSW5qZWN0YWJsZSxcbiAgT3B0aW9uYWwsXG4gIFNraXBTZWxmLFxuICBJbmplY3Rpb25Ub2tlblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5pbXBvcnQgeyBXSU5ET1cgfSBmcm9tICduZ3gtd2luZG93LXRva2VuJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIENsaXBib2FyZFNlcnZpY2Uge1xuICBwcml2YXRlIHRlbXBUZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudCB8IHVuZGVmaW5lZDtcbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdChET0NVTUVOVCkgcHJpdmF0ZSBkb2N1bWVudDogYW55LFxuICAgIEBJbmplY3QoV0lORE9XKSBwcml2YXRlIHdpbmRvdzogYW55XG4gICkge31cbiAgcHVibGljIGdldCBpc1N1cHBvcnRlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgISF0aGlzLmRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZCAmJlxuICAgICAgISF0aGlzLmRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZCgnY29weScpXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBpc1RhcmdldFZhbGlkKFxuICAgIGVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50XG4gICk6IGJvb2xlYW4ge1xuICAgIGlmIChcbiAgICAgIGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50IHx8XG4gICAgICBlbGVtZW50IGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudFxuICAgICkge1xuICAgICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICdJbnZhbGlkIFwidGFyZ2V0XCIgYXR0cmlidXRlLiBQbGVhc2UgdXNlIFwicmVhZG9ubHlcIiBpbnN0ZWFkIG9mIFwiZGlzYWJsZWRcIiBhdHRyaWJ1dGUnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKCdUYXJnZXQgc2hvdWxkIGJlIGlucHV0IG9yIHRleHRhcmVhJyk7XG4gIH1cblxuICAvKipcbiAgICogY29weUZyb21JbnB1dEVsZW1lbnRcbiAgICovXG4gIHB1YmxpYyBjb3B5RnJvbUlucHV0RWxlbWVudChcbiAgICB0YXJnZXRFbG06IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50XG4gICk6IGJvb2xlYW4ge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnNlbGVjdFRhcmdldCh0YXJnZXRFbG0pO1xuICAgICAgY29uc3QgcmUgPSB0aGlzLmNvcHlUZXh0KCk7XG4gICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKHRhcmdldEVsbSwgdGhpcy53aW5kb3cpO1xuICAgICAgcmV0dXJuIHJlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBmYWtlIHRleHRhcmVhIGVsZW1lbnQsIHNldHMgaXRzIHZhbHVlIGZyb20gYHRleHRgIHByb3BlcnR5LFxuICAgKiBhbmQgbWFrZXMgYSBzZWxlY3Rpb24gb24gaXQuXG4gICAqL1xuICBwdWJsaWMgY29weUZyb21Db250ZW50KGNvbnRlbnQ6IHN0cmluZykge1xuICAgIGlmICghdGhpcy50ZW1wVGV4dEFyZWEpIHtcbiAgICAgIHRoaXMudGVtcFRleHRBcmVhID0gdGhpcy5jcmVhdGVUZW1wVGV4dEFyZWEodGhpcy5kb2N1bWVudCwgdGhpcy53aW5kb3cpO1xuICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMudGVtcFRleHRBcmVhKTtcbiAgICB9XG4gICAgdGhpcy50ZW1wVGV4dEFyZWEudmFsdWUgPSBjb250ZW50O1xuICAgIHJldHVybiB0aGlzLmNvcHlGcm9tSW5wdXRFbGVtZW50KHRoaXMudGVtcFRleHRBcmVhKTtcbiAgfVxuXG4gIC8vIHJlbW92ZSB0ZW1wb3JhcnkgdGV4dGFyZWEgaWYgYW55XG4gIHB1YmxpYyBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLnRlbXBUZXh0QXJlYSkge1xuICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMudGVtcFRleHRBcmVhKTtcbiAgICAgIHRoaXMudGVtcFRleHRBcmVhID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8vIHNlbGVjdCB0aGUgdGFyZ2V0IGh0bWwgaW5wdXQgZWxlbWVudFxuICBwcml2YXRlIHNlbGVjdFRhcmdldChcbiAgICBpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50XG4gICk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaW5wdXRFbGVtZW50LnNlbGVjdCgpO1xuICAgIGlucHV0RWxlbWVudC5zZXRTZWxlY3Rpb25SYW5nZSgwLCBpbnB1dEVsZW1lbnQudmFsdWUubGVuZ3RoKTtcbiAgICByZXR1cm4gaW5wdXRFbGVtZW50LnZhbHVlLmxlbmd0aDtcbiAgfVxuXG4gIHByaXZhdGUgY29weVRleHQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKTtcbiAgfVxuICAvLyBSZW1vdmVzIGN1cnJlbnQgc2VsZWN0aW9uIGFuZCBmb2N1cyBmcm9tIGB0YXJnZXRgIGVsZW1lbnQuXG4gIHByaXZhdGUgY2xlYXJTZWxlY3Rpb24oXG4gICAgaW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudCxcbiAgICB3aW5kb3c6IFdpbmRvd1xuICApIHtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tdW51c2VkLWV4cHJlc3Npb25cbiAgICBpbnB1dEVsZW1lbnQgJiYgaW5wdXRFbGVtZW50LmJsdXIoKTtcbiAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gIH1cblxuICAvLyBjcmVhdGUgYSBmYWtlIHRleHRhcmVhIGZvciBjb3B5IGNvbW1hbmRcbiAgcHJpdmF0ZSBjcmVhdGVUZW1wVGV4dEFyZWEoXG4gICAgZG9jOiBEb2N1bWVudCxcbiAgICB3aW5kb3c6IFdpbmRvd1xuICApOiBIVE1MVGV4dEFyZWFFbGVtZW50IHtcbiAgICBjb25zdCBpc1JUTCA9IGRvYy5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkaXInKSA9PT0gJ3J0bCc7XG4gICAgbGV0IHRhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgIHRhID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG4gICAgLy8gUHJldmVudCB6b29taW5nIG9uIGlPU1xuICAgIHRhLnN0eWxlLmZvbnRTaXplID0gJzEycHQnO1xuICAgIC8vIFJlc2V0IGJveCBtb2RlbFxuICAgIHRhLnN0eWxlLmJvcmRlciA9ICcwJztcbiAgICB0YS5zdHlsZS5wYWRkaW5nID0gJzAnO1xuICAgIHRhLnN0eWxlLm1hcmdpbiA9ICcwJztcbiAgICAvLyBNb3ZlIGVsZW1lbnQgb3V0IG9mIHNjcmVlbiBob3Jpem9udGFsbHlcbiAgICB0YS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgdGEuc3R5bGVbaXNSVEwgPyAncmlnaHQnIDogJ2xlZnQnXSA9ICctOTk5OXB4JztcbiAgICAvLyBNb3ZlIGVsZW1lbnQgdG8gdGhlIHNhbWUgcG9zaXRpb24gdmVydGljYWxseVxuICAgIGNvbnN0IHlQb3NpdGlvbiA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2MuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICB0YS5zdHlsZS50b3AgPSB5UG9zaXRpb24gKyAncHgnO1xuICAgIHRhLnNldEF0dHJpYnV0ZSgncmVhZG9ubHknLCAnJyk7XG4gICAgcmV0dXJuIHRhO1xuICB9XG59XG4vLyB0aGlzIHBhdHRlcm4gaXMgbWVudGlvbmVkIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIvaXNzdWVzLzEzODU0IGluICM0M1xuZXhwb3J0IGZ1bmN0aW9uIENMSVBCT0FSRF9TRVJWSUNFX1BST1ZJREVSX0ZBQ1RPUlkoXG4gIGRvYzogRG9jdW1lbnQsXG4gIHdpbjogV2luZG93LFxuICBwYXJlbnREaXNwYXRjaGVyOiBDbGlwYm9hcmRTZXJ2aWNlXG4pIHtcbiAgcmV0dXJuIHBhcmVudERpc3BhdGNoZXIgfHwgbmV3IENsaXBib2FyZFNlcnZpY2UoZG9jLCB3aW4pO1xufVxuXG5leHBvcnQgY29uc3QgQ0xJUEJPQVJEX1NFUlZJQ0VfUFJPVklERVIgPSB7XG4gIGRlcHM6IFtcbiAgICBET0NVTUVOVCBhcyBJbmplY3Rpb25Ub2tlbjxEb2N1bWVudD4sXG4gICAgV0lORE9XIGFzIEluamVjdGlvblRva2VuPERvY3VtZW50PixcbiAgICBbbmV3IE9wdGlvbmFsKCksIG5ldyBTa2lwU2VsZigpLCBDbGlwYm9hcmRTZXJ2aWNlXVxuICBdLFxuICBwcm92aWRlOiBDbGlwYm9hcmRTZXJ2aWNlLFxuICB1c2VGYWN0b3J5OiBDTElQQk9BUkRfU0VSVklDRV9QUk9WSURFUl9GQUNUT1JZXG59O1xuIiwiaW1wb3J0IHtcbiAgRGlyZWN0aXZlLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RMaXN0ZW5lcixcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IENsaXBib2FyZFNlcnZpY2UgfSBmcm9tICcuL25neC1jbGlwYm9hcmQuc2VydmljZSc7XG5cbkBEaXJlY3RpdmUoe1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGlyZWN0aXZlLXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAnW25neENsaXBib2FyZF0nXG59KVxuZXhwb3J0IGNsYXNzIENsaXBib2FyZERpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWlucHV0LXJlbmFtZVxuICBASW5wdXQoJ25neENsaXBib2FyZCcpIHB1YmxpYyB0YXJnZXRFbG06IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgQElucHV0KCkgcHVibGljIGNiQ29udGVudDogc3RyaW5nO1xuXG4gIEBPdXRwdXQoKSBwdWJsaWMgY2JPblN1Y2Nlc3M6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgQE91dHB1dCgpIHB1YmxpYyBjYk9uRXJyb3I6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY2xpcGJvYXJkU3J2OiBDbGlwYm9hcmRTZXJ2aWNlKSB7fVxuXG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1lbXB0eVxuICBwdWJsaWMgbmdPbkluaXQoKSB7fVxuXG4gIHB1YmxpYyBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmNsaXBib2FyZFNydi5kZXN0cm95KCk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50LnRhcmdldCddKVxuICBwdWJsaWMgb25DbGljayhldmVudDogRXZlbnQpIHtcbiAgICBpZiAoIXRoaXMuY2xpcGJvYXJkU3J2LmlzU3VwcG9ydGVkKSB7XG4gICAgICB0aGlzLmhhbmRsZVJlc3VsdChmYWxzZSwgdW5kZWZpbmVkKTtcbiAgICB9IGVsc2UgaWYgKFxuICAgICAgdGhpcy50YXJnZXRFbG0gJiZcbiAgICAgIHRoaXMuY2xpcGJvYXJkU3J2LmlzVGFyZ2V0VmFsaWQodGhpcy50YXJnZXRFbG0pXG4gICAgKSB7XG4gICAgICB0aGlzLmhhbmRsZVJlc3VsdChcbiAgICAgICAgdGhpcy5jbGlwYm9hcmRTcnYuY29weUZyb21JbnB1dEVsZW1lbnQodGhpcy50YXJnZXRFbG0pLFxuICAgICAgICB0aGlzLnRhcmdldEVsbS52YWx1ZVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2JDb250ZW50KSB7XG4gICAgICB0aGlzLmhhbmRsZVJlc3VsdChcbiAgICAgICAgdGhpcy5jbGlwYm9hcmRTcnYuY29weUZyb21Db250ZW50KHRoaXMuY2JDb250ZW50KSxcbiAgICAgICAgdGhpcy5jYkNvbnRlbnRcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpcmVzIGFuIGV2ZW50IGJhc2VkIG9uIHRoZSBjb3B5IG9wZXJhdGlvbiByZXN1bHQuXG4gICAqIEBwYXJhbSBzdWNjZWVkZWRcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlUmVzdWx0KHN1Y2NlZWRlZDogYm9vbGVhbiwgY29waWVkQ29udGVudDogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgaWYgKHN1Y2NlZWRlZCkge1xuICAgICAgdGhpcy5jYk9uU3VjY2Vzcy5lbWl0KHsgaXNTdWNjZXNzOiB0cnVlLCBjb250ZW50OiBjb3BpZWRDb250ZW50IH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNiT25FcnJvci5lbWl0KHsgaXNTdWNjZXNzOiBmYWxzZSB9KTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IENsaXBib2FyZERpcmVjdGl2ZSB9IGZyb20gJy4vbmd4LWNsaXBib2FyZC5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgQ0xJUEJPQVJEX1NFUlZJQ0VfUFJPVklERVIgfSBmcm9tICcuL25neC1jbGlwYm9hcmQuc2VydmljZSc7XG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE5neFdpbmRvd1Rva2VuTW9kdWxlIH0gZnJvbSAnbmd4LXdpbmRvdy10b2tlbic7XG5leHBvcnQgKiBmcm9tICcuL25neC1jbGlwYm9hcmQuZGlyZWN0aXZlJztcbmV4cG9ydCAqIGZyb20gJy4vbmd4LWNsaXBib2FyZC5zZXJ2aWNlJztcblxuQE5nTW9kdWxlKHtcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZSwgTmd4V2luZG93VG9rZW5Nb2R1bGVdLFxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6b2JqZWN0LWxpdGVyYWwtc29ydC1rZXlzXG4gIGRlY2xhcmF0aW9uczogW0NsaXBib2FyZERpcmVjdGl2ZV0sXG4gIGV4cG9ydHM6IFtDbGlwYm9hcmREaXJlY3RpdmVdLFxuICBwcm92aWRlcnM6IFtDTElQQk9BUkRfU0VSVklDRV9QUk9WSURFUl1cbn0pXG5leHBvcnQgY2xhc3MgQ2xpcGJvYXJkTW9kdWxlIHt9XG4iXSwibmFtZXMiOlsiSW5qZWN0YWJsZSIsIkluamVjdCIsIkRPQ1VNRU5UIiwiV0lORE9XIiwiT3B0aW9uYWwiLCJTa2lwU2VsZiIsIkV2ZW50RW1pdHRlciIsIkRpcmVjdGl2ZSIsIklucHV0IiwiT3V0cHV0IiwiSG9zdExpc3RlbmVyIiwiTmdNb2R1bGUiLCJDb21tb25Nb2R1bGUiLCJOZ3hXaW5kb3dUb2tlbk1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO1FBYUUsMEJBQzRCLFVBQ0Y7WUFERSxhQUFRLEdBQVIsUUFBUTtZQUNWLFdBQU0sR0FBTixNQUFNO1NBQzVCOzhCQUNPLHlDQUFXOzs7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